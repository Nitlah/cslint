/*
 * ZLint Copyright 2021 Regents of the University of Michigan
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 * implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */

package util

import (
	"github.com/zmap/zcrypto/encoding/asn1"
)

var evoids = map[string]bool{
	//确定
	"0.4.0.2042.1.4":                  true,
	"0.4.0.2042.1.5":                  true,
	"1.3.6.1.4.1.4146.1.2":            true,
	"1.3.6.1.4.1.36305.2":             true,
	"2.16.840.1.113733.1.7.48.1":      true,
	"2.16.840.1.114028.10.1.2":        true,
	"2.16.840.1.114412.3.2":           true,
	"2.23.140.1.3":                    true,
	"1.3.6.1.4.1.29836.1.10":          true,
	"1.3.6.1.4.1.4788.2.202.1":        true,
	"1.3.6.1.4.1.14777.6.1.2":         true,
	"2.16.528.1.1003.1.2.7":           true,
	"2.16.156.112554.3":               true,
	"2.16.792.3.0.3.1.1.5":            true,
	"1.2.156.112559.1.1.7.1":          true,
	"1.2.156.112559.1.1.6.1":          true,
	"1.2.156.112570.1.1.3":            true,
	"1.2.40.0.17.1.22":                true,
	"1.3.6.1.4.1.13177.10.1.3.10":     true,
	"1.3.6.1.4.1.14370.1.6":           true,
	"1.3.6.1.4.1.14777.6.1.1":         true,
	"1.3.6.1.4.1.17326.10.14.2.1.2":   true,
	"1.3.6.1.4.1.17326.10.14.2.2.2":   true,
	"1.3.6.1.4.1.17326.10.8.12.1.2":   true,
	"1.3.6.1.4.1.17326.10.8.12.2.2":   true,
	"1.3.6.1.4.1.18332.55.1.1.2.22":   true,
	"1.3.6.1.4.1.18332.55.1.1.5.22":   true,
	"1.3.6.1.4.1.18332.55.1.1.6.22":   true,
	"1.3.6.1.4.1.22234.2.5.2.3.1":     true,
	"1.3.6.1.4.1.23223.1.1.1":         true,
	"1.3.6.1.4.1.23223.2":             true,
	"1.3.6.1.4.1.34697.2.1":           true,
	"1.3.6.1.4.1.34697.2.2":           true,
	"1.3.6.1.4.1.34697.2.3":           true,
	"1.3.6.1.4.1.34697.2.4":           true,
	"1.3.6.1.4.1.4146.1.1":            true,
	"1.3.6.1.4.1.6334.1.100.1":        true,
	"1.3.6.1.4.1.6449.1.2.1.5.1":      true,
	"1.3.6.1.4.1.6449.1.2.1.6.1":      true,
	"1.3.6.1.4.1.782.1.2.1.8.1":       true,
	"1.3.6.1.4.1.7879.13.24.1":        true,
	"1.3.6.1.4.1.8024.0.2.100.1.2":    true,
	"2.16.578.1.26.1.3.3":             true,
	"2.16.756.1.83.21.0":              true,
	"2.16.756.1.89.1.2.1.1":           true,
	"2.16.792.3.0.4.1.1.4":            true,
	"2.16.840.1.113733.1.7.23.6":      true,
	"2.16.840.1.114404.1.1.2.4.1":     true,
	"2.16.840.1.114412.1.3.0.2":       true,
	"2.16.840.1.114412.2.1":           true,
	"2.16.840.1.114413.1.7.23.3":      true,
	"2.16.840.1.114414.1.7.23.3":      true,
	"2.23.140.1.31":                   true,
	"1.2.392.200091.100.721.1":        true,
	"1.3.159.1.17.1":                  true,
	"1.3.171.1.1.10.5.2":              true,
	"1.3.6.1.4.1.40869.1.1.22.3":      true,
	"2.16.756.5.14.7.4.8":             true,
	"2.16.840.1.114171.500.9":         true,
	"2.16.840.1.114414.1.7.24.3":      true,
	"2.23.140.1.1":                    true,
	"1.2.156.112562.2.2.15":           true,
	"1.2.1.156.112562.2.2.11":         true,
	"1.3.6.1.4.1.30360.3.3.3.4.4.3.3": true,
	"1.3.6.1.4.1.38064.1.3.3.2":       true,
	"1.3.6.1.4.1.22234.3.5.3.1":       true,
	"1.3.6.1.4.1.38064.1.3.1.4":       true,
	"1.3.6.1.4.1.22234.2.14.3.11":     true,
	"1.3.6.1.4.1.26513.1.1.4":         true,
	"1.3.6.1.4.1.26513.1.3.3":         true,
	"1.3.171.1.1.1.10.3":              true,
	"1.3.171.1.1.1.10.5":              true,
	"1.3.171.1.1.10.5.1":              true,
	"1.3.6.1.4.1.311.60.1.1":          true,
	"1.3.6.1.4.1.38064.1.1.1.0":       true,
	"1.2.616.1.113527.2.5.1.1":        true,
	"1.2.616.1.113527.2.5.1.7":        true,
	"2.16.840.1.113839.0.6.9":         true,
	"2.16.840.1.113839.0.6.14.1":      true,
	"0.4.0.194112.1.4":                true,
	"1.3.6.1.4.1.22234.3.5.3.2":       true,
	"2.16.756.1.17.3.22.32":           true,
	"2.16.756.1.17.3.22.34":           true,
	"2.16.756.1.17.3.22.51":           true,
	"2.16.840.1.114414.1.7.24.2":      true,
	"1.3.6.1.4.1.23624.10.1.35.1.0":   true,
	"1.3.6.1.4.1.18332.55.1.1.2.12":   true,
	"1.3.6.1.4.1.18332.55.1.1.5.12":   true,
	"1.3.6.1.4.1.18332.55.1.1.6.12":   true,
	"1.3.6.1.4.1.26513.1.1.3.3":       true,
	"1.2.616.1.113527.2.102.3.1":      true,
	"1.2.616.1.113527.2.102.3.2":      true,
	"2.16.792.3.0.4.1.1.14":           true,
	"2.16.840.1.114535.3.2":           true,
	"1.3.6.1.4.1.30360.3.3.3.3.4.3.4": true,
	"2.16.840.1.114404.2.4.1":         true,
	"2.16.756.1.17.3.62.10":           true,
	//不确定
	//"1.2.156.112570.1.2.2":            true,

	//"2.16.756.1.17.3.61.10": true,
}

// IsEV returns true if the input is a known Extended Validation OID.
func IsEV(in []asn1.ObjectIdentifier) bool {
	for _, oid := range in {
		if _, ok := evoids[oid.String()]; ok {
			return true
		}
	}
	return false
}

const OnionTLD = ".onion"
